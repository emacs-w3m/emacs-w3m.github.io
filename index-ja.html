<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-2022-JP">
<title>Text browser works on emacs</title>
</head>
<body bgcolor="#EEEEEE">
<p align="right">[<a href="index-en.html">English</a> / Japanese]</p>

<h1>Emacs 上で w3m を動かそう</h1>

<p>
Emacs 上で動作するブラウザと言えば，普通
<a href="http://www.cs.indiana.edu/elisp/w3/docs.html">W3</a>
のことですが，動作が非常に遅いので，なかなか常用しようという気になれません．
</p>
<p>
それに対して，<a href="http://w3m.sourceforge.net/">w3m</a>
というテキストベースで動作するブラウザがあり，
非常に軽快に動作するので重宝しているのですが，
端末に移動しなければいけないのが面倒です．
</p>
<p>
そこで，w3m を HTML の rendering engine として使用し，表示とインタフェースのみを
Emacs で動かすようにすればいいんじゃないだろうか，ということを考えました．
</p>

<ul>
 <li><a href="#download">ダウンロード</a>
 <li><a href="#requirement">動作環境</a>
 <li><a href="#install">インストール</a>
 <li><a href="#config">設定</a>
 <li><a href="#mailing_list">メーリングリスト</a>
 <li><a href="#link">リンク集</a>
 <li><a href="#members">開発者</a>
 <li><a href="#report">連絡先</a>
</ul>


<img src="w3m-el.png" alt="emacs-w3m の動作例" width="384" height="333">


<p>
XEmacs または Emacs21 では画像のインライン表示が可能です．
<a href="w3m-vs-w3.png">どちらが本物か</a>見比べてみてください．
動作する様子を具体的に見てみたい方は，<a
href="http://namazu.org/~satoru/x11rec/">x11rec</a> で撮影した<a
href="video.gif">ビデオ</a>をご覧ください．
</p>


<hr>
<h2><a name="download">ダウンロード</a></h2>
<ul>
 <li>安定版
     <ul>
      <li><code><a href="w3m_el-1.3.tar.gz">w3m_el-1.3.tar.gz</a></code> (2002年7月7日)
     </ul>
 <li>旧版
     <ul>
      <li><code><a href="w3m_el-1.0.tar.gz">w3m_el-1.0.tar.gz</a></code> (2001年5月9日)
      <li><code><a href="w3m_el-1.2.tar.gz">w3m_el-1.2.tar.gz</a></code> (2001年11月6日)
      <li><code><a href="w3m_el-1.2.1.tar.gz">w3m_el-1.2.1.tar.gz</a></code> (2001年11月12日)
      <li><code><a href="w3m_el-1.2.2.tar.gz">w3m_el-1.2.2.tar.gz</a></code> (2001年12月6日)
      <li><code><a href="w3m_el-1.2.3.tar.gz">w3m_el-1.2.3.tar.gz</a></code> (2001年12月21日)
      <li><code><a href="w3m_el-1.2.4.tar.gz">w3m_el-1.2.4.tar.gz</a></code> (2002年1月8日)
      <li><code><a href="w3m_el-1.2.5.tar.gz">w3m_el-1.2.5.tar.gz</a></code> (2002年3月2日)
      <li><code><a href="w3m_el-1.2.6.tar.gz">w3m_el-1.2.6.tar.gz</a></code> (2002年3月12日)
      <li><code><a href="w3m_el-1.2.7.tar.gz">w3m_el-1.2.7.tar.gz</a></code> (2002年6月3日)
      <li><code><a href="w3m_el-1.2.8.tar.gz">w3m_el-1.2.8.tar.gz</a></code> (2002年6月20日)
     </ul>
 <li>開発版
     <ul>
      <li><code><a href="w3m_el-1.3.1rc1.tar.gz">w3m_el-1.3.1rc1.tar.gz</a></code> (20027月16日)
     </ul>
</ul>
<p>
emacs-w3m は，CVS を使って共同開発しているので，
以下の手順で最新の開発版が入手できます．
</p>
<blockquote>
<pre>
% cvs -d :pserver:anonymous@cvs.namazu.org:/storage/cvsroot login
CVS password: # パスワードは設定されていません．単に Enter/Return キーを押してください．
% cvs -d :pserver:anonymous@cvs.namazu.org:/storage/cvsroot co emacs-w3m
</pre>
</blockquote>
<p>
また，<a href="http://cvs.namazu.org/emacs-w3m/">ViewCVS</a>
でソースを閲覧することもできます．
</p>


<hr>
<h2><a name="requirement">動作環境</a></h2>
<p>
emacs-w3m を動かすには，最新の w3m が必要です．
最新版は，2002年7月16日に公開された w3m-0.3.1 で，以下の場所から入手できます．
</p>
<ul>
 <li><code><a href="http://prdownloads.sourceforge.net/w3m/">http://prdownloads.sourceforge.net/w3m/w3m-0.3.1.tar.gz</a></code>
</ul>
<p>
emacs-w3m は，w3m のバージョンに強く依存していますので，
既にインストール済みの w3m を利用する場合は，そのバージョンを再確認してください．
</p>
<p>
emacs-w3m に同梱して配布されている shimbun ライブラリを利用するためには，
FLIM を前もってインストールしておく必要があります．詳細については，
<code><a href="http://cvs.namazu.org/emacs-w3m/README.shimbun.ja?rev=1.35&content-type=text/plain">README.shimbun.ja</a></code> を確認してください．
</p>
<dl>
 <dt>a) Emacs-21.x
 <dd><p>
     emacs-w3m を動かすために，余分にインストールが必要なモジュールはありません．
     </p>
 <dt>b) Emacs-20.x
 <dd><p>
     emacs-w3m を動かすために，余分にインストールが必要なモジュールはありません．
     </p>
     <p>
     BITMAP-MULE パッケージをインストールしておくと，
     WEB ページのインライン画像を白黒表示させることができます．
     </p>
 <dt>c) XEmacs
 <dd><p>
     APEL を前もってインストールしておく必要があります．
     </p>
     <blockquote>
      <strong>注意:</strong>
      バージョン 1.23 以降の XEmacs 用 APEL パッケージが，
      MULE あり/なし両方の XEmacs で emacs-w3m を動作させるために使うことができます．
      しかしそれらのパッケージは std11 モジュールのために FLIM
      と(そしておそらく他のパッケージ，例えば
      Wanderlust や T-gnus とも)相性が良くありません．
      ですから，オリジナルの APEL をインストールすることをお勧めします．
     </blockquote>
     <p>
     XEmacs-21.x に emacs-w3m をインストールする場合は，必ず
     <code><a href="http://www.lcdf.org/gifsicle/">gifsicle</a></code>
     プログラムもインストールして下さい．
     現在すべての XEmacs-21.x にはオプティマイズされたアニメーション gif 
     が正常に表示されなかったりある種のインターレース gif
     を表示しようとするとクラッシュしてしまうバグがあります．emacs-w3m 
     は <code>gifsicle</code> を利用して，gif データをXEmacs 21.x
     で扱える形式に変換します．
     </p>
 <dt>d) Mule-2.3 (based on Emacs-19.34)
 <dd><p>
     APEL と「<strong>新しい custom</strong>」と
     <code>regexp-opt.el(c)</code> モジュールが必要です．詳しくは，次の
     <a href="#requirement_emacs_19.34">Emacs-19.34 についての説明</a>を参照してください．
     </p>
     <p>
     BITMAP-MULE パッケージを用いて WEB
     ページのインライン画像を白黒表示させる場合には，
     付属のパッチ(<code><a href="http://cvs.namazu.org/emacs-w3m/patches/mule-2.3@19.34.patch?rev=1.1&content-type=text/plain">patches/mule-2.3@19.34.patch</a></code>)を適用して
     Mule を作り直すことを強くお勧めします．
     そうしないと，高い確率で Mule が固まってしまい，Mule を
     kill せざるを得なくなるでしょう．
     </p>
 <dt><a name="requirement_emacs_19.34">e) Emacs-19.34 (without MULE)</a>
 <dd><p>
     APEL を前もってインストールしておく必要があります．
     </p>
     <p>
     emacs-w3m は「<strong><a href="http://www.dina.kvl.dk/~abraham/custom/">新しい
     custom</a></strong>」パッケージを必要とします．
     Emacs-19.34 または Mule-2.3 を使っている場合は，emacs-w3m
     をインストールする前にそれをインストールしなければなりません．
     特に Mule-2.3 を使う場合は，APEL に附属している
     <code><a href="http://cvs.m17n.org/cgi-bin/viewcvs/apel/README.ja?rev=HEAD&content-type=text/plain">README.ja</a></code>
     も必ず調べて下さい．
     </p>
     <p>
     また，emacs-w3m は <code>regexp-opt.el(c)</code> モジュールを必要としますが，
     Emacs-19.34 や Mule-2.3 などの古い Emacsen には含まれていません．
     あなたが使っている Emacs が該当する場合は，前もって，以下のように
     <code>regexp-opt.el(c)</code> モジュールをインストールする必要があります．
     </p>
<blockquote>
<pre>
% cp attic/regexp-opt.el /usr/local/share/mule/site-lisp
% cd /usr/local/share/mule/site-lisp
% mule -q -no-site-file -batch -f batch-byte-compile regexp-opt.el
</pre>
</blockquote>
</dl>

<hr>
<h2><a name="install">インストール</a></h2>
<p>
最初に，emacs-w3m
を利用するために<a href="#requirement">必要な条件</a>が満たされているか確認してください．
</p>

<dl>
 <dt><h3><a name="install_unix">一般的な UNIX 環境にインストールする場合</a></h3>
 <dd><p>
     最初に，<code>configure</code> スクリプトを実行してください．
     </p>
<blockquote>
<pre>
% ./configure
</pre>
</blockquote>
     <p>
     APEL や FLIM などの必要なモジュールが，
     標準的ではないディレクトリにインストールされている場合には，
     <em>--with-addpath</em>
     オプションを使って，そのディレクトリを指定する必要があります．
     </p>
<blockquote>
<pre>
% ./configure --with-addpath=/opt/share/apel:/opt/share/flim
</pre>
</blockquote>
     <p>
     次に，同梱されている emacs-lisp
     のプログラムを適当なディレクトリにインストールするため，
     次のコマンドを実行してください．
     </p>
<blockquote>
<pre>
% make
# make install
</pre>
</blockquote>
     <p>
     加えて，XEmacs や Emacs21
     用のアイコンを，以下のようにインストールすることができます．
     </p>
<blockquote>
<pre>
# make install-icons
</pre>
</blockquote>
     <p>
     <em>install</em> の代わりに <em>install-package</em> を使うと，XEmacs の
     package としてインストールすることもできます．
     </p>
<blockquote>
<pre>
% make
# make install-package
</pre>
</blockquote>
     <p>
     この場合 <em>install-icons</em> を実行する必要はありません．
     </p>
 <dt><h3><a name="install_nonunix">非 UNIX 環境にインストールする場合</a></h3>
 <dd><p>
     <code>configure</code> スクリプトを実行できない，
     または <code>make</code> コマンドが存在しない環境の場合は，
     以下のコマンドを実行してください．
     </p>
<blockquote>
<pre>
# emacs -batch -q -no-site-file -l w3mhack.el NONE -f w3mhack-nonunix-install
</pre>
</blockquote>
     <p>
     APEL や FLIM などの必要なモジュールが，
     標準的ではないディレクトリにインストールされている場合には，
     以下のようにそのディレクトリを指定する必要があります．
     </p>
<blockquote>
<pre>
# emacs -batch -q -no-site-file -l w3mhack.el //c/share/apel://c/share/flim -f w3mhack-nonunix-install
</pre>
</blockquote>
</dl>


<hr>
<h2><a name="config">設定</a></h2>
<p>
最初に，以下の設定を <code>~/.emacs</code> に追加してください．
</p>
<blockquote>
<pre>
(autoload 'w3m "w3m" "Interface for w3m on Emacs." t)
</pre>
</blockquote>
<p>
後は，<i>M-x w3m</i> とすれば起動するはずです．
</p>
<p>
他の付属プログラムを使用するには，追加の設定が必要な場合があります．詳細については，
個々の付属プログラムのソースファイルの先頭に記載されているコメントを参照してください．
良く分からない場合は，とりあえず，以下の設定を <code>~/.emacs</code>
に追加しておいてください．
</p>
<blockquote>
<pre>
(autoload 'w3m-find-file "w3m" "w3m interface function for local file." t)
(autoload 'w3m-browse-url "w3m" "Ask a WWW browser to show a URL." t)
(autoload 'w3m-search "w3m-search" "Search QUERY using SEARCH-ENGINE." t)
(autoload 'w3m-weather "w3m-weather" "Display weather report." t)
(autoload 'w3m-antenna "w3m-antenna" "Report chenge of WEB sites." t)
</pre>
</blockquote>
<p>
また，T-gnus や Wanderlust などの SEMI MUA 上で，メッセージ中の text/html
パートを emacs-w3m を使って表示させるには，以下の設定を
<code>~/.emacs</code> に追加する必要があります．
</p>
<blockquote>
<pre>
(require 'mime-w3m)
</pre>
</blockquote>


<hr>
<h2><a name="mailing_list">メーリングリスト</a></h2>
<p>
emacs-w3m についての情報交換を行うためのメーリングリストを開設しています．
参加を希望される方は，<code>emacs-w3m-ctl@namazu.org</code>
宛に以下のような内容のメールを送ってください．
</p>
<blockquote>
<pre>
subscribe ANATANO Namae
</pre>
</blockquote>
<p>
上記サンプル中の「ANATANO Namae」という部分は，実際の名前に置き換えてください．
メーリングリスト本体のアドレスは，<code>emacs-w3m@namazu.org</code> です．
また，メーリングリストの過去記事も<a href="ml/">公開されています</a>．
</p>


<hr>
<h2><a name="link">リンク集</a></h2>
<ul>
 <li><a href="http://w3m.sourceforge.net/">w3m</a>
     <ul>
      <li><a href="http://www2u.biglobe.ne.jp/~hsaka/w3m/index-ja.html">w3m-m17n</a>
      <li><a href="http://pub.ks-and-ks.ne.jp/prog/w3mmee/">w3mmee</a>
     </ul>
 <li><a href="http://www.cs.indiana.edu/elisp/w3/docs.html">W3</a>
 <li><a href="ftp://ftp.m17n.org/pub/mule/apel/">APEL</a>
 <li><a href="ftp://ftp.m17n.org/pub/mule/flim/">FLIM</a>
</ul>


<hr>
<h2><a name="members">開発者</a></h2>
(50音順)
<ul>
 <li><a href="http://www.nijino.com/ari/">有沢 明宏</a>
 <li><a href="http://www.taiyo.co.jp/~gotoh/">後藤 俊一</a>
 <li><a href="http://www.netlaputa.ne.jp/~hshirai/">白井 秀行</a>
 <li><a href="http://namazu.org/~satoru/">高林 哲</a>
 <li><a href="http://www-nagao.kuee.kyoto-u.ac.jp/member/tsuchiya/">土屋 雅稔</a>
 <li><a href="http://www.gohome.org/teranisi/">寺西 裕一</a>
 <li>西田 圭介
 <li>山岡 克美
</ul>


<hr>
<h2><a name="report">連絡先</a></h2>
<p>
不具合報告などは <code>emacs-w3m@namazu.org</code> 宛にお願いします．
</p>


</body>
</html>
<!-- Local Variables: -->
<!-- use-kuten-for-period: nil -->
<!-- use-touten-for-comma: nil -->
<!-- End: -->
